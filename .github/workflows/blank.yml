name: ğŸ“Š Update GitHub Stats

on:
  schedule:
    # Executa toda segunda-feira Ã s 08:00 (horÃ¡rio de BrasÃ­lia)
    - cron: '0 11 * * 1'
  # Permite executar manualmente
  workflow_dispatch:
  # Executa quando fizer push
  push:
    branches: [ main ]

jobs:
  update-stats:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸš€ Checkout repositÃ³rio
      uses: actions/checkout@v3
      with:
        fetch-depth: 0
        token: ${{ secrets.GH_TOKEN }}

    - name: ğŸ“¦ Configurar Git
      run: |
        git config --global user.name "MarcoTuliops22"
        git config --global user.email "marcotuliops22@gmail.com"
        git config --global pull.rebase false

    - name: ğŸ“ˆ Gerar estatÃ­sticas de linguagens
      run: |
        # Criar arquivo de estatÃ­sticas
        echo "# ğŸ“Š EstatÃ­sticas do GitHub - Marco TÃºlio" > STATS.md
        echo "" >> STATS.md
        echo "## ğŸš€ Linguagens Mais Usadas" >> STATS.md
        echo "" >> STATS.md
        echo '![Top Languages](https://github-readme-stats.vercel.app/api/top-langs/?username=MarcoTuliops22&layout=compact&theme=tokyonight&hide_border=true&langs_count=8&hide=html,css,scss&card_width=500)' >> STATS.md
        echo "" >> STATS.md
        echo "## ğŸ“ˆ EstatÃ­sticas Gerais" >> STATS.md
        echo "" >> STATS.md
        echo '![GitHub Stats](https://github-readme-stats.vercel.app/api?username=MarcoTuliops22&show_icons=true&theme=tokyonight&hide_border=true&count_private=true)' >> STATS.md
        echo "" >> STATS.md
        echo "## ğŸ”¥ Streak" >> STATS.md
        echo "" >> STATS.md
        echo '![GitHub Streak](https://streak-stats.demolab.com/?user=MarcoTuliops22&theme=tokyonight&hide_border=true)' >> STATS.md
        echo "" >> STATS.md
        echo "---" >> STATS.md
        echo "*Ãšltima atualizaÃ§Ã£o: $(date '+%d/%m/%Y %H:%M:%S')*" >> STATS.md

    - name: ğŸ“¤ Fazer commit das mudanÃ§as
      run: |
        git add STATS.md
        git diff --quiet && git diff --staged --quiet || (git commit -m "ğŸ“Š Atualizar estatÃ­sticas - $(date '+%d/%m/%Y')" && git push origin main)
        
    - name: âœ… Status do workflow
      run: |
        echo "âœ… EstatÃ­sticas atualizadas com sucesso!"
        echo "ğŸ“… PrÃ³xima atualizaÃ§Ã£o automÃ¡tica: Toda segunda-feira Ã s 08:00"